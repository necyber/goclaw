# Project Status (2026-02-26)

本文件是基于当前仓库代码状态的校正版评估，重点区分：
- 已实现并可用
- 已实现但未接入主链路
- 未开始/仅规划

---

## 一、当前结论（校正版）

结论：项目已进入“实现与集成并行阶段”。
- 核心模块（DAG/Lane/Storage/Memory/Signal/HTTP/Metrics/gRPC 处理器）已具备较完整实现。
- 主要短板不在“是否有代码”，而在“是否接入主执行链路”。

---

## 二、能力分层

### 2.1 已实现并可用
- DAG 构建、拓扑排序、执行计划生成
- 调度器按 layer 并发执行（同步等待层完成）
- Lane 体系（Channel + Redis 实现、背压、限流、去重、重试等）
- 存储层（Memory + Badger）
- Memory 系统（Vector/BM25/Hybrid 检索 + FSRS 衰减）
- Signal Bus（local/redis）与 steer/interrupt/collect 模式
- HTTP API（workflow/health/memory）与 Prometheus 指标
- Web UI（路由与静态资源支持）
- gRPC 协议定义、生成代码、handlers、client、interceptors

### 2.2 已实现但未接入主链路
- HTTP `SubmitWorkflow` 当前仅落库，未触发实际执行闭环
- Scheduler 仍直接 goroutine 执行，未通过 `lane.Manager.Submit` 调度执行
- gRPC server 可启动，但主程序未完成业务 service 注册与引擎适配接线

### 2.3 未开始/仅规划
- 集群协调（etcd/Consul 节点发现、分片一致性策略）尚未打通
- NATS 事件总线未接入主运行链路
- Saga 分布式事务处于规划态

---

## 三、路线图映射（更贴近代码现状）

- Phase 1：核心能力基本完成，但“提交 -> 执行 -> 状态回写 -> 查询/取消”的闭环未彻底贯通。
- Phase 2：相比旧评估更接近“部分完成偏高”状态（持久化、混合记忆、Redis Lane、Signal 模式已有实现）；但分布式协调仍缺关键拼图。
- Phase 3：HTTP + Metrics + Web UI 基础已具备；gRPC 处理器与客户端已有实现，但服务接线与端到端运行链路仍待打通；事务能力未实现。

---

## 四、下一阶段优先级（修订）

### Priority 1 - 打通执行闭环（最高优先）
目标：`HTTP Submit -> Engine 执行 -> 状态持久化 -> 可查询/可取消`
- 提交后触发执行（同步或异步模式明确化）
- 工作流/任务状态机全程落库（含 StartedAt/CompletedAt/Result/Error）
- 取消与超时路径统一状态处理
- API 响应与查询结果体现真实执行状态（非“仅已提交”）

### Priority 2 - 打通 gRPC 主链路
目标：gRPC 与 HTTP 能力对齐，并可在主程序中真实可用
- 在 gRPC server 启动时注册 Workflow/Streaming/Batch/Admin/Signal 服务
- 实现引擎适配层，完成 handlers 与 engine 的接口接线
- 校验、错误码、拦截器链在运行态统一验证

### Priority 3 - 分布式最小可用集群
目标：多节点运行与状态一致性
- 引入节点发现与任务分片策略
- 明确 Redis Lane 在多节点下的一致性边界
- 逐步接入 NATS 事件总线

### Priority 4 - 事务与可靠性增强
目标：向生产级故障恢复靠拢
- Saga 编排/补偿模型落地
- 失败重试、幂等、死信与恢复策略完善

---

## 五、文档维护建议

- `STATUS` 建议按日期版本化（本文件即为首个校正版样式）。
- 每次状态更新附“已实现但未接入”清单，避免把“有代码”误写成“已可用”。
- `ROADMAP.md`、`README.md`、`docs/STATUS.md` 建议同步校对，减少对外口径不一致。
